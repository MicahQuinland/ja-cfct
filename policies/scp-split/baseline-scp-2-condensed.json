{"Version":"2012-10-17","Statement":[{"Sid":"DenyActionToSpecificCloudFormation","Effect":"Deny","Action":["cloudformation:Cancel*","cloudformation:Continue*","cloudformation:Create*","cloudformation:Delete*","cloudformation:Detect*","cloudformation:Execute*","cloudformation:Record*","cloudformation:Set*","cloudformation:Signal*","cloudformation:TagResource","cloudformation:UntagResource","cloudformation:Update*"],"Resource":["arn:aws:cloudformation:*:*:stack/StackSet-*ControlTower*"],"Condition":{"ArnNotLikeIfExists":{"aws:PrincipalARN":["arn:aws:iam::*:role/AWSControlTowerExecution","arn:aws:iam::*:role/AWSCloudFormationStackSetExecutionRole"]}}},{"Sid":"PreventLambdaURLsandPublicLambda","Effect":"Deny","Action":["lambda:CreateFunctionUrlConfig","lambda:UpdateFunctionUrlConfig"],"Resource":"arn:aws:lambda:*:*:function:*"},{"Sid":"DenyKMSActions","Effect":"Deny","Action":["kms:ScheduleKeyDeletion","kms:Delete*"],"Resource":"*","Condition":{"ArnNotLike":{"aws:PrincipalARN":["arn:aws:iam::*:role/AWSControlTowerExecution","arn:aws:iam::*:role/service-role/AWSControlTowerAdmin"]}}},{"Sid":"DenyAWSMarketplaceAccess","Effect":"Deny","Action":["aws-marketplace:*"],"Resource":["*"]},{"Sid":"DenyBillingChanges","Effect":"Deny","Action":["aws-portal:ModifyAccount","aws-portal:ModifyBilling","aws-portal:ModifyPaymentMethods"],"Resource":["*"],"Condition":{"ArnNotLike":{"aws:PrincipalARN":["arn:aws:iam::*:role/AWSControlTowerExecution"]}}},{"Sid":"DenyDisableEMRPublicAccessBlock","Effect":"Deny","Action":["elasticmapreduce:PutBlockPublicAccessConfiguration"],"Resource":["*"]},{"Sid":"PreventPublicSecrets","Effect":"Deny","Action":"secretsmanager:PutResourcePolicy","Resource":"*","Condition":{"Bool":{"secretsmanager:BlockPublicPolicy":"false"}}},{"Sid":"ProtectRejectServiceCatalog","Effect":"Deny","Action":"servicecatalog:RejectPortfolioShare","Resource":"*","Condition":{"ArnNotLikeIfExists":{"aws:PrincipalArn":["arn:aws:iam::*:role/AWSControlTowerExecution"]}}},{"Sid":"ProtectSendMessageToExternalEmail","Effect":"Deny","Action":["sns:Subscribe"],"Resource":"*","Condition":{"StringNotLike":{"sns:Endpoint":["*@pwc.com","arn:aws:sqs:*:*:*","arn:aws:lambda:*:*:*"]},"StringNotEquals":{"sns:Protocol":["email","sqs","lambda"]},"ArnNotLikeIfExists":{"aws:PrincipalArn":["arn:aws:iam::*:role/AWSControlTowerExecution"]}}},{"Sid":"ProtectAssumeAdminRoles","Effect":"Deny","Action":"sts:AssumeRole","Resource":["arn:aws:iam::*:role/AWSControlTowerExecution","arn:aws:iam::*:role/AWSReservedSSO*"],"Condition":{"ArnNotLikeIfExists":{"aws:PrincipalArn":["arn:aws:iam::*:role/AWSControlTowerExecution"]}}}]}